<!doctype html>
<html lang="pt-BR">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Music Cover ‚Äî Jogo de Vota√ß√£o</title>
    <style>
        :root {
            --bg: #0f1724;
            --card: #0b1220;
            --glass: rgba(255, 255, 255, 0.06);
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: Inter, system-ui, sans-serif;
            background: #000;
            color: #fff;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #app {
            width: 100%;
            max-width: 1100px;
            margin: 24px;
        }

        .bg {
            position: fixed;
            inset: 0;
            background-image: url('background.png');
            background-size: cover;
            background-position: center;
            filter: brightness(.45);
            z-index: -1;
        }

        header.start-screen {
            background: rgba(0, 0, 0, .6);
            padding: 28px;
            border-radius: 12px;
        }

        h1 {
            margin: 0 0 6px;
            font-size: 28px;
        }

        p.lead {
            margin: 0 0 18px;
            opacity: .9;
        }

        .controls {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            align-items: center;
        }

        .control {
            background: var(--glass);
            padding: 12px;
            border-radius: 8px;
        }

        label {
            display: block;
            font-size: 13px;
            margin-bottom: 6px;
        }

        input[type=number],
        input[type=text] {
            padding: 8px;
            border-radius: 6px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: transparent;
            color: #fff;
            text-align: center;
        }

        input[type=number] {
            width: 72px;
        }

        .player-name {
            width: 120px;
        }

        button.primary {
            padding: 10px 18px;
            border-radius: 10px;
            border: none;
            background: #10b981;
            color: #012;
            text-transform: uppercase;
            font-weight: 700;
            cursor: pointer;
        }

        .game-area {
            display: none;
            margin-top: 18px;
        }

        .covers {
            display: flex;
            gap: 12px;
            justify-content: center;
        }

        .cover {
            width: 170px;
            height: 170px;
            flex: 0 0 170px;
            border-radius: 8px;
            overflow: hidden;
            background: #222;
            border: 4px solid rgba(255, 255, 255, 0.04);
            transition: transform .25s ease, opacity .25s ease;
        }

        .cover img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        .status {
            margin-top: 16px;
            text-align: center;
        }

        .status .line {
            font-weight: 700;
        }

        .vote-panel {
            display: none;
            margin-top: 18px;
            padding: 18px;
            background: var(--glass);
            border-radius: 10px;
            text-align: center;
        }

        .vote-panel input[type=password] {
            font-size: 20px;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.06);
            background: transparent;
            color: #fff;
            width: 140px;
            text-align: center;
        }

        .results {
            display: none;
            margin-top: 18px;
            text-align: center;
            background: transparent !important;
            box-shadow: none !important;
            padding: 0;
            animation: fadeIn 0.8s ease;
        }

        .winner {
            font-size: 1.8em;
            font-weight: 900;
            color: #ffb400;
            margin-bottom: 10px;
            text-shadow: 0 0 12px rgba(0, 0, 0, 0.7);
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }
    </style>
</head>

<body>
    <div class="bg"></div>
    <div id="app">
        <!-- TELA INICIAL -->
        <header class="start-screen" id="startScreen">
            <h1>Music Cover</h1>
            <p class="lead">Adivinhe a capa da m√∫sica</p>

            <div class="controls">
                <div class="control">
                    <label for="numPlayers">N√∫mero de jogadores</label>
                    <input id="numPlayers" type="number" min="2" max="6" value="4">
                </div>

                <div class="control" id="playersArea">
                    <label>Nomes dos jogadores</label>
                    <div id="playerInputs" style="display:flex;flex-wrap:wrap;gap:8px;"></div>
                </div>

                <div style="align-self:end">
                    <button class="primary" id="startBtn">Iniciar</button>
                </div>
            </div>
        </header>

        <!-- JOGO -->
        <main class="game-area" id="gameArea">
            <div class="covers" id="covers"></div>
            <div class="status" id="status">
                <div class="line" id="statusLine">Pronto</div>
                <div id="roundInfo">Rodada 0 / 5</div>
            </div>

            <div class="vote-panel" id="votePanel">
                <div id="voteLine">Vota√ß√£o</div>
                <input id="voteInput" type="password" inputmode="numeric" maxlength="1" placeholder="1-4">
                <div style="margin-top:10px">
                    <button id="confirmVote" class="primary">Confirmar</button>
                </div>
            </div>

            <div class="results" id="results">
                <div class="winner" id="winnerText"></div>
                <div id="voteSummary"></div>
                <div style="margin-top:12px">
                    <button id="nextRound" class="primary">Pr√≥xima Rodada</button>
                </div>
            </div>
        </main>

        <!-- SONS -->
        <audio id="bgMusic" loop src="musica_fundo.mp3"></audio>
        <audio id="fxVote" src="enter.ogg"></audio>
        <audio id="fxReveal" src="results.mp3"></audio>
        <audio id="fxRoundEnd" src="transicao.ogg"></audio>
        <audio id="fxWin" src="vitoria.mp3"></audio>
    </div>

    <script>
        const TOTAL_ROUNDS = 9;
        const COVER_SIZE = 400;
        const USE_PICSUM = true;
        const MUSICAS = [
            "musicas/1 AInicio.MP3",
            "musicas/2 All Through The Night.mp3",
            "musicas/3 Bill Medley Jennifer Warnes - (I've Had) The ...",
            "musicas/4 Can't Take My Eyes Off You.mp3",
            "musicas/6 Elton John - Skyline Pigeon.mp3",
            "musicas/7 Night Fever.mp3",
            "musicas/8 Tony Ronald - Help (Get Me Some Help).mp3",
            "musicas/9 Year Of The Cat - Al Stewart.mp3",
            "musicas/10 Yellow River.mp3",
            "musicas/11 You And Me.mp3",
            "musicas/Baail Atoladinha.mp3",
            "musicas/Baile Tapinha.mp3",
            "musicas/Baile Garota Nota 100.mp3",
            "musicas/Baile Dan√ßa da Motinha.mp3",
            "musicas/Baile Rap do Silva.mp3",
            "musicas/Baile Vingadora.mp3",
            "musicas/Bailee Careless Whisper.mp3",
            "musicas/Bailee Os Milk √© Liso.mp3",
            "musicas/Baili Glamurosa.mp3",
            "musicas/Baille Bonde do Tigr√£o.mp3",
            "musicas/Ball About That Bass.mp3",
            "musicas/Balone.mp3",
            "musicas/Balways.mp3",
            "musicas/Bas Good As New.mp3",
            "musicas/Beijo Geladinho.mp3",
            "musicas/Blame.mp3",
            "musicas/Bon Jovi.mp3",
            "musicas/Boom Clap.mp3",
            "musicas/Boys.mp3",
            "musicas/Brasil Tchau I Have to go now.mp3",
            "musicas/Chattahoochee.mp3",
            "musicas/Cheia de Manias.mp3",
            "musicas/Chiquitita.mp3",
            "musicas/Cilada.mp3",
            "musicas/Cold Heart.mp3",
            "musicas/Could be love.mp3",
            "musicas/Dancing Queen.mp3",
            "musicas/Dancing With Myself.mp3",
            "musicas/Depois do Prazer.mp3",
            "musicas/Desejo de Amar.mp3",
            "musicas/Die Young.mp3",
            "musicas/Expresso.mp3",
            "musicas/Dont stop the music.mp3",
            "musicas/Dynamite.mp3",
            "musicas/ET.mp3",
            "musicas/Girlfriend.mp3",
            "musicas/Fernando.mp3",
            "musicas/Firework.mp3",
            "musicas/Gimme! Gimme! Gimme! (A Man After Midnight).mp3",
            "musicas/Holiday.mp3",
            "musicas/Girls Just Want to Have Fun.mp3",
            "musicas/Gonna make you sweet.mp3",
            "musicas/Happy.mp3",
            "musicas/Hips Dont Lie.mp3",
            "musicas/I Wanna Dance with Somebody.mp3",
            "musicas/How Deep Is Your Love .mp3",
            "musicas/I Have A Dream.mp3",
            "musicas/I Kissed a Girl.mp3",
            "musicas/I Started A Joke.mp3",
            "musicas/It Must Have Been Love.mp3",
            "musicas/I Want To Break Free.mp3",
            "musicas/I Will Survive.mp3",
            "musicas/I'll Trie.mp3",
            "musicas/Last Friday Night.mp3",
            "musicas/It_s Raining Men.mp3",
            "musicas/Jump.mp3",
            "musicas/Just Dance Fatima.mp3",
            "musicas/Knowing Me, Knowing You.mp3",
            "musicas/Marrom Bombom.mp3",
            "musicas/Lay All Your Love On Me.mp3",
            "musicas/Lean on.mp3",
            "musicas/Like A Virgin.mp3",
            "musicas/Mamma mia.mp3",
            "musicas/More Than A Woman.mp3",
            "musicas/Melo de Carla Cintia.mp3",
            "musicas/Men at Work.mp3",
            "musicas/Money, Money, Money.mp3",
            "musicas/One Of Us.mp3",
            "musicas/Mr. Saxobeat.mp3",
            "musicas/Never Gonna Give You Up.mp3",
            "musicas/Night Fever .mp3",
            "musicas/One Kiss.mp3",
            "musicas/Only Girl.mp3",
            "musicas/Pop AARadio - Copia.mp3",
            "musicas/Pump Up The Jam.mp3",
            "musicas/Rabiosa.mp3",
            "musicas/Someone You Loved.mp3",
            "musicas/Rockabye.mp3",
            "musicas/S.O.S.mp3",
            "musicas/Safe And Sound.mp3",
            "musicas/Shake It Off.mp3",
            "musicas/Take It Off.mp3",
            "musicas/Stayin_ Alive.mp3",
            "musicas/Stereo Love.mp3",
            "musicas/Super Trouper.mp3",
            "musicas/Take A Chance On Me.mp3",
            "musicas/Thank You For The Music.mp3",
            "musicas/Taste.mp3",
            "musicas/Teenage Dream.mp3",
            "musicas/Telegrama.mp3",
            "musicas/Telephone.mp3",
            "musicas/Too Much Heaven.mp3",
            "musicas/The Name Of The Game.mp3",
            "musicas/The Winner Takes It All.mp3",
            "musicas/Tik ToK.mp3",
            "musicas/Wake Me Up Before You Go-Go.mp3",
            "musicas/Vamba ARadio.mp3",
            "musicas/Voulez Vous.mp3",
            "musicas/Voyage Voyage.mp3",
            "musicas/Waterloo.mp3",
            "musicas/We Found Love.mp3",
            "musicas/We R Who We R.mp3",
            "musicas/Worth It.mp3",
            "musicas/You Should Be Dancing.mp3",
            "musicas/You are not alone.mp3",
            "musicas/Your Love.mp3"
        ];

        const state = {
            playerNames: [],
            round: 0,
            votes: [],
            currentVotingIndex: 0,
            covers: [],
            scores: {}
        };

        // Elementos do DOM
        const numPlayersInput = document.getElementById('numPlayers');
        const startBtn = document.getElementById('startBtn');
        const startScreen = document.getElementById('startScreen');
        const gameArea = document.getElementById('gameArea');
        const coversEl = document.getElementById('covers');
        const statusLine = document.getElementById('statusLine');
        const roundInfo = document.getElementById('roundInfo');
        const votePanel = document.getElementById('votePanel');
        const voteLine = document.getElementById('voteLine');
        const voteInput = document.getElementById('voteInput');
        const confirmVote = document.getElementById('confirmVote');
        const resultsEl = document.getElementById('results');
        const winnerText = document.getElementById('winnerText');
        const voteSummary = document.getElementById('voteSummary');
        const nextRoundBtn = document.getElementById('nextRound');

        const audioBg = document.getElementById('bgMusic');
        const fxVote = document.getElementById('fxVote');
        const fxReveal = document.getElementById('fxReveal');
        const fxRoundEnd = document.getElementById('fxRoundEnd');
        const fxWin = document.getElementById('fxWin');
        const fxClick = new Audio('click.mp3');

        // --- Inputs dos jogadores ---
        function renderPlayerInputs() {
            const num = parseInt(numPlayersInput.value);
            const playerInputs = document.getElementById('playerInputs');
            playerInputs.innerHTML = '';
            for (let i = 0; i < num; i++) {
                const input = document.createElement('input');
                input.type = 'text';
                input.placeholder = `Jogador ${i + 1}`;
                input.className = 'player-name';
                playerInputs.appendChild(input);
            }
        }
        numPlayersInput.oninput = renderPlayerInputs;
        renderPlayerInputs();

        // --- Iniciar jogo ---
        startBtn.onclick = () => {
            fxClick.currentTime = 0;
            fxClick.play();

            const inputs = [...document.querySelectorAll('.player-name')];
            const names = inputs.map(i => i.value.trim()).filter(v => v);
            if (names.length < 2) return alert('Digite pelo menos 2 nomes de jogadores!');
            state.playerNames = names;
            startScreen.style.display = 'none';
            gameArea.style.display = 'block';
            state.round = 0;
            state.scores = {};
            names.forEach(n => state.scores[n] = 0);
            nextRound();
        };

        // --- Gerar e renderizar capas ---
        function gerarCovers() {
            const urls = [];
            for (let i = 0; i < 4; i++) {
                urls.push(USE_PICSUM
                    ? `https://picsum.photos/${COVER_SIZE}?random=${Date.now()}-${i}`
                    : `https://source.unsplash.com/${COVER_SIZE}x${COVER_SIZE}/?album,music&sig=${Math.random() * 9999}`);
            }
            return urls;
        }

        function renderCovers() {
            coversEl.innerHTML = '';
            state.covers.forEach((url, i) => {
                const c = document.createElement('div');
                c.className = 'cover';
                c.innerHTML = `<img src="${url}" alt="Capa ${i + 1}">`;
                coversEl.appendChild(c);
            });
        }

        // --- Pr√≥xima rodada ---
        function nextRound() {
            resultsEl.style.display = 'none';
            votePanel.style.display = 'none';
            state.round++;
            if (state.round > TOTAL_ROUNDS) return showFinalResults();

            roundInfo.textContent = `Rodada ${state.round} / ${TOTAL_ROUNDS}`;
            statusLine.textContent = 'Gerando capas...';

            const musica = MUSICAS[Math.floor(Math.random() * MUSICAS.length)];
            audioBg.src = musica;
            audioBg.play().catch(() => { });

            state.covers = gerarCovers();
            renderCovers();

            state.votes[state.round - 1] = Array(state.playerNames.length).fill(null);
            state.currentVotingIndex = 0;

            setTimeout(() => {
                statusLine.textContent = 'Iniciando vota√ß√£o';
                iniciarVotacao();
            }, 700);
        }

        // --- Vota√ß√£o ---
        function iniciarVotacao() {
            voteInput.value = '';
            votePanel.style.display = 'block';
            mostrarJogador();
        }

        function mostrarJogador() {
            const i = state.currentVotingIndex;
            const nome = state.playerNames[i];
            voteLine.textContent = `√â a vez de ${nome}`;
            statusLine.textContent = `Jogador ${i + 1}: ${nome} votando`;
            voteInput.focus();
        }

        confirmVote.onclick = () => {
            const val = voteInput.value.trim();
            if (!/^[1-4]$/.test(val)) return alert('Vote entre 1 e 4!');

            state.votes[state.round - 1][state.currentVotingIndex] = parseInt(val);
            fxVote.currentTime = 0;
            fxVote.play();

            state.currentVotingIndex++;
            if (state.currentVotingIndex >= state.playerNames.length) {
                fxRoundEnd.currentTime = 0;
                fxRoundEnd.play();
                finalizarVotacao();
            } else {
                voteInput.value = '';
                mostrarJogador();
            }
        };

        voteInput.onkeydown = e => { if (e.key === 'Enter') confirmVote.click(); };

        // --- Finalizar vota√ß√£o ---
        function finalizarVotacao() {
            votePanel.style.display = 'none';
            statusLine.textContent = 'Finaliza√ß√£o da vota√ß√£o...';

            const msg = document.createElement('div');
            msg.textContent = 'FINALIZA√á√ÉO DA VOTA√á√ÉO';
            Object.assign(msg.style, {
                position: 'fixed', left: '50%', top: '30%', transform: 'translateX(-50%)',
                background: 'rgba(0,0,0,0.7)', padding: '20px 30px', borderRadius: '10px', fontWeight: '800'
            });
            document.body.appendChild(msg);
            msg.animate([{ opacity: 0 }, { opacity: 1 }, { opacity: 0 }], { duration: 1600 });
            setTimeout(() => { document.body.removeChild(msg); revealResults(); }, 1600);
        }

        // --- Revelar resultados ---
        function revealResults() {
            fxReveal.currentTime = 0;
            fxReveal.play();

            const votesThisRound = state.votes[state.round - 1] || [];
            const totalCovers = state.covers.length;
            const counts = new Array(totalCovers).fill(0);
            votesThisRound.forEach(v => {
                const n = parseInt(v, 10);
                if (!isNaN(n) && n >= 1 && n <= totalCovers) counts[n - 1]++;
            });

            const maxVotes = Math.max(...counts);
            const winners = counts.map((c, i) => (c === maxVotes ? i : null)).filter(i => i !== null);

            const coverEls = Array.from(document.querySelectorAll('.cover'));
            coverEls.forEach((el, idx) => {
                if (winners.includes(idx)) {
                    el.style.transform = 'scale(1.07)';
                    el.style.boxShadow = '0 8px 30px rgba(255,215,0,0.6)';
                    el.style.opacity = 1;
                } else {
                    el.style.opacity = 0.4;
                    el.style.transform = '';
                    el.style.boxShadow = '';
                }
            });

            const vencedoresRodada = [];
            state.playerNames.forEach((nome, i) => {
                const voto = parseInt(votesThisRound[i]);
                if (winners.includes(voto - 1)) {
                    state.scores[nome] = (state.scores[nome] || 0) + 1;
                    vencedoresRodada.push(nome);
                }
            });

            resultsEl.style.display = 'block';
            let textoCapa = '';
            if (maxVotes === 0) textoCapa = 'Nenhum voto v√°lido nesta rodada.';
            else if (winners.length === 1) textoCapa = `Capa vencedora: ${winners[0] + 1} com ${maxVotes} voto(s)!`;
            else textoCapa = `Empate entre capas: ${winners.map(i => i + 1).join(', ')} (${maxVotes} voto(s) cada)`;

            winnerText.innerHTML = `<div style="font-size:1.6em;font-weight:800;color:#ffb400;margin-bottom:10px;text-shadow:0 0 10px rgba(0,0,0,0.6);">${textoCapa}</div>`;
            if (vencedoresRodada.length > 0) {
                voteSummary.innerHTML = `<div style="font-size:1em;font-weight:600;color:#e5e5e5;margin-top:8px;text-shadow:0 0 5px rgba(0,0,0,0.5);">üèÜ Jogadores que pontuaram: <span style="color:#ffda6a">${vencedoresRodada.join(', ')}</span></div>`;
            } else {
                voteSummary.innerHTML = `<div style="font-size:1em;opacity:0.8;margin-top:8px;">Ningu√©m acertou nesta rodada üò¢</div>`;
            }

            nextRoundBtn.style.display = 'inline-block';
        }

        // --- Pr√≥xima rodada bot√£o ---
        nextRoundBtn.onclick = () => {
            fxClick.currentTime = 0;
            fxClick.play();
            nextRound();
        };

        // --- Resultados finais ---
        function showFinalResults() {
            const maxScore = Math.max(...Object.values(state.scores));
            const campeoes = Object.entries(state.scores)
                .filter(([_, p]) => p === maxScore)
                .map(([n]) => n);

            const texto = campeoes.length > 1 ? `Empate entre ${campeoes.join(', ')}` : `Campe√£o: ${campeoes[0]}!`;
            const placar = Object.entries(state.scores)
                .map(([n, p]) => `${n}: ${p} ponto(s)`).join(' ‚Äî ');

            const overlay = document.createElement('div');
            Object.assign(overlay.style, {
                position: 'fixed', inset: 0, background: 'rgba(0,0,0,0.9)',
                color: '#fff', display: 'flex', flexDirection: 'column', alignItems: 'center',
                justifyContent: 'center', fontSize: '2em', zIndex: 9999, animation: 'fadeIn 1.5s'
            });
            overlay.innerHTML = `<div style="text-align:center">
    <div style="font-size:2.5em;color:#ffb400;font-weight:900;">üèÜ ${texto}</div>
    <div style="margin-top:20px;font-size:1.2em;">${placar}</div>
    <div style="margin-top:40px;font-size:0.7em;opacity:0.8;">Obrigado por jogar!</div>
  </div>`;

            // Bot√£o de nova partida
            const btn = document.createElement('button');
            btn.textContent = "Nova Partida";
            btn.className = "primary";
            btn.style.marginTop = "20px";
            btn.onclick = () => {
                document.body.removeChild(overlay);
                reiniciarPartida(true); // true = zera pontos
            };
            overlay.querySelector('div').appendChild(btn);

            document.body.appendChild(overlay);
            fxWin.currentTime = 0;
            fxWin.play();
            confete();
        }

        // --- Reiniciar partida ---
        function reiniciarPartida(zeraPontuacao = false) {
            fxClick.currentTime = 0;
            fxClick.play();

            state.round = 0;
            state.votes = [];
            state.covers = [];
            state.currentVotingIndex = 0;

            if (zeraPontuacao) {
                state.scores = {};
                state.playerNames.forEach(n => state.scores[n] = 0);
            }

            resultsEl.style.display = 'none';
            votePanel.style.display = 'none';
            roundInfo.textContent = `Rodada 0 / ${TOTAL_ROUNDS}`;
            statusLine.textContent = 'Preparando nova partida...';

            setTimeout(nextRound, 500);
        }

        // --- Confete ---
        function confete() {
            const canvas = document.createElement('canvas');
            canvas.width = innerWidth;
            canvas.height = innerHeight;
            canvas.style.position = 'fixed';
            canvas.style.inset = 0;
            canvas.style.pointerEvents = 'none';
            canvas.style.zIndex = 99999;
            document.body.appendChild(canvas);
            const ctx = canvas.getContext('2d');
            const confs = Array.from({ length: 150 }).map(() => ({
                x: Math.random() * innerWidth,
                y: Math.random() * -innerHeight,
                r: 3 + Math.random() * 6,
                d: Math.random() * 3 + 2,
                c: `hsl(${Math.random() * 360},100%,60%)`
            }));
            function draw() {
                ctx.clearRect(0, 0, innerWidth, innerHeight);
                confs.forEach(p => {
                    ctx.beginPath();
                    ctx.fillStyle = p.c;
                    ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
                    ctx.fill();
                    p.y += p.d;
                    if (p.y > innerHeight) {
                        p.y = -10;
                        p.x = Math.random() * innerWidth;
                    }
                });
                requestAnimationFrame(draw);
            }
            draw();
        }

        let confeteCanvas = null;
        let confeteAnimId = null;

        function confete() {
            confeteCanvas = document.createElement('canvas');
            confeteCanvas.width = innerWidth;
            confeteCanvas.height = innerHeight;
            confeteCanvas.style.position = 'fixed';
            confeteCanvas.style.inset = 0;
            confeteCanvas.style.pointerEvents = 'none';
            confeteCanvas.style.zIndex = 99999;
            document.body.appendChild(confeteCanvas);
            const ctx = confeteCanvas.getContext('2d');

            const confs = Array.from({ length: 150 }).map(() => ({
                x: Math.random() * innerWidth,
                y: Math.random() * -innerHeight,
                r: 3 + Math.random() * 6,
                d: Math.random() * 3 + 2,
                c: `hsl(${Math.random() * 360},100%,60%)`
            }));

            function draw() {
                ctx.clearRect(0, 0, innerWidth, innerHeight);
                confs.forEach(p => {
                    ctx.beginPath();
                    ctx.fillStyle = p.c;
                    ctx.arc(p.x, p.y, p.r, 0, Math.PI * 2);
                    ctx.fill();
                    p.y += p.d;
                    if (p.y > innerHeight) {
                        p.y = -10;
                        p.x = Math.random() * innerWidth;
                    }
                });
                confeteAnimId = requestAnimationFrame(draw);
            }
            draw();
        }

        // --- Reiniciar partida ---
        function reiniciarPartida(zeraPontuacao = false) {
            fxClick.currentTime = 0;
            fxClick.play();

            state.round = 0;
            state.votes = [];
            state.covers = [];
            state.currentVotingIndex = 0;

            if (zeraPontuacao) {
                state.scores = {};
                state.playerNames.forEach(n => state.scores[n] = 0);
            }

            resultsEl.style.display = 'none';
            votePanel.style.display = 'none';
            roundInfo.textContent = `Rodada 0 / ${TOTAL_ROUNDS}`;
            statusLine.textContent = 'Preparando nova partida...';

            // STOP confete
            if (confeteCanvas) {
                cancelAnimationFrame(confeteAnimId);
                document.body.removeChild(confeteCanvas);
                confeteCanvas = null;
                confeteAnimId = null;
            }

            setTimeout(nextRound, 500);
        }
    </script>
</body>
<!-- Eu realizei a formata√ß√£o do documento inteiro, parece at√© mesmo IA kkkkkkk-->
<!-- Danilo jorge - Esse site foi realizado para aprimorar meus conhecimentos em programa√ß√£o! -->
</html>